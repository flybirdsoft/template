/*
write by : wuweiwei
github   : www.github.com/flybirdsoft
blogs    : www.cnblogs.com/wsoft

*/
!function(e){var t={_startSymbol:"\\${",_endSymbol:"}",templateElement:{},contentNode:null};t.startSymbol=function(e){var t,n="",i="^$*+?{}[]|.";for(t=0;t<e.length;t++)i.indexOf(e.substr(t,1))>=0&&(n+="\\"),n+=e.substr(t,1);this._startSymbol=n},t.endSymbol=function(e){var t,n="",i="^$*+?{}[]|.";for(t=0;t<e.length;t++)i.indexOf(e.substr(t,1))>=0&&(n+="\\"),n+=e.substr(t,1);this._endSymbol=e},t.repeat=function(e){if(void 0==e.data)throw new Error("参数名称不对,参数是{},缺少data");if(void 0==e.repeatId&&void 0==e.repeatElement)throw new Error("参数名称不对,参数是{},缺少repeatElement或repeatId");var n,i,o,r,l,a,s,r,d,p,m,b={string:""},g=[],c=0,y=null,f=null,u=function(){},h={},S={},v=null,_="";for(l=e.repeatElement||$(e.repeatId)[0],a=l.parentNode,(void 0==e.type||void 0!=e.type&&"cover"==e.type)&&t.deleteNode(l),void 0==e.template&&(e.template=l.innerHTML),void 0==e.data.length?(c=1,g[0]=e.data):(c=e.data.length,g=e.data),void 0!=e.count&&e.count<=c&&(c=e.count),void 0!=e.process&&(u=e.process||e.onprocess),y=l,f=a.lastChild,n=c-1;n>=0;n--){for(o=g[n],h={index:n,item:g[n]},s=u.call(this,h),v=document.createElement(l.nodeName),i=0;i<l.attributes.length;i++){_=l.attributes.item(i).value;for(r in s)p=this._startSymbol+r+this._endSymbol,m=new RegExp(p,"g"),_=_.replace(m,s[r]);for(r in o)p=this._startSymbol+r+this._endSymbol,m=new RegExp(p,"g"),_=_.replace(m,o[r]);v.setAttribute(l.attributes.item(i).name,_)}b.string=e.template;for(r in s)"object"!=typeof s[r]?(p=this._startSymbol+r+this._endSymbol,m=new RegExp(p,"g"),b.string=b.string.replace(m,s[r])):t.getScope(s,r,b);for(r in o)"object"!=typeof o[r]?(p=this._startSymbol+r+this._endSymbol,m=new RegExp(p,"g"),b.string=b.string.replace(m,o[r])):t.getScope(o,r,b);v.innerHTML=b.string,void 0!=e.type&&"append"==e.type?(a.insertBefore(v,f.nextSibling),v.style.display="block",v.setAttribute("templateItem","templateItem"),v=f):(a.insertBefore(v,y.nextSibling),v.style.display="block",v.setAttribute("templateItem","templateItem"))}l.style.display="none",void 0!=e.bind&&(S.target=$(e.id)[0],S.data=e.data,S.template=e.template,S.id=e.id,d=e.bind.call(this,S))},t.getScope=function(e,t,n,i){var o,r,l="";if(r=e[t],"object"==typeof r){l=void 0==i?t:i;for(o in r){if(l+="."+o,"object"==typeof r[o])return void this.getScope(r,o,n,l);strV=this._startSymbol+l+this._endSymbol,reg=new RegExp(strV,"g"),n.string=n.string.replace(reg,r[o])}}},t.deleteNode=function(e){for(var t,n=e.nextSibling,i=1==n.nodeType&&"templateItem"==n.getAttribute("templateItem")||1!=n.nodeType;null!=n&&i;)t=n.nextSibling,n.parentNode.removeChild(n),n=t},e.T=e.template=t}(window);